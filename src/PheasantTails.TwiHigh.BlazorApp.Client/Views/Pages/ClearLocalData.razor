@page "/clear"
@attribute [Authorize]
@inherits TwiHighPageBase
@inject ITimelineWorkerService TimelineWorkerService
@inject IFeedWorkerService FeedWorkerService

<PageTitle>キャッシュクリア中 - ツイハイ！</PageTitle>
<THLoading />

@code
{
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender)
        {
            return;
        }
        await TimelineWorkerService.CacheClearAsync();
        await FeedWorkerService.CacheClearAsync();
        Navigation.NavigateToHomePage(false, true);
    }
}